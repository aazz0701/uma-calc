<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>賽馬娘儲值優惠計算機</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>

    <style>
        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 2px; }
        * { -webkit-tap-highlight-color: transparent; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <!-- 錯誤訊息顯示區 (預設隱藏) -->
    <div id="error-message" style="display:none; padding: 20px; background: #fee2e2; color: #b91c1c; border: 1px solid #ef4444; margin: 20px; border-radius: 8px;">
        <h3 style="font-weight: bold; margin-bottom: 8px;">發生錯誤</h3>
        <pre id="error-text" style="white-space: pre-wrap; font-size: 12px;"></pre>
    </div>

    <div id="root">
        <div style="display: flex; justify-content: center; align-items: center; height: 100vh; color: #64748b;">
            載入中...
        </div>
    </div>

    <!-- 錯誤捕捉腳本 -->
    <script>
        window.onerror = function(message, source, lineno, colno, error) {
            document.getElementById('error-message').style.display = 'block';
            document.getElementById('error-text').textContent = 'Error: ' + message + '\nLine: ' + lineno + '\nSource: ' + source;
            document.getElementById('root').style.display = 'none';
        };
    </script>

    <script type="text/babel">
        const { useState, useMemo } = React;

        // --- Icons ---
        const Icon = ({ children, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const ShoppingCart = (props) => <Icon {...props}><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></Icon>;
        const Crown = (props) => <Icon {...props}><path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"/></Icon>;
        const TrendingUp = (props) => <Icon {...props}><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></Icon>;
        const Zap = (props) => <Icon {...props}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></Icon>;
        const CalculatorIcon = (props) => <Icon {...props}><rect x="4" y="2" width="16" height="20" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></Icon>;
        const Check = (props) => <Icon {...props}><polyline points="20 6 9 17 4 12"/></Icon>;
        const XIcon = (props) => <Icon {...props}><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></Icon>;
        const ChevronUp = (props) => <Icon {...props}><polyline points="18 15 12 9 6 15"/></Icon>;
        const Star = (props) => <Icon {...props}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></Icon>;
        const Trash = (props) => <Icon {...props}><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></Icon>;

        // --- Data ---
        const PRODUCTS = [
            { 
                id: "sp_1", 
                name: "3.5th Anniv. 紀念寶石", 
                sub: "3次限定", 
                gems: 7500, 
                price: 2690, 
                points: 2590, 
                limit: 3, 
                badge: "", 
                category: "limited", 
                desc: "紀念期間3次限定" 
            },
            { 
                id: "sp_2", 
                name: "3.5th Anniv. 附贈SSR交換券", 
                sub: "1次限定", 
                gems: 5000, 
                price: 2690, 
                points: 2590, 
                limit: 1, 
                badge: "", 
                category: "limited", 
                desc: "附贈SSR交換券" 
            },
            { 
                id: "sp_3", 
                name: "3.5th Anniv. 附贈★3交換券", 
                sub: "1次限定", 
                gems: 5000, 
                price: 2690, 
                points: 2590, 
                limit: 1, 
                badge: "", 
                category: "limited", 
                desc: "附贈★3交換券" 
            },
            { 
                id: "sp_4", 
                name: "3.5th Anniv. 紀念寶石", 
                sub: "4次限定", 
                gems: 1500, 
                price: 570, 
                points: 790,
                limit: 4, 
                badge: "", 
                category: "limited", 
                desc: "紀念期間4次限定" 
            },
            { 
                id: "sp_5", 
                name: "3.5th Anniv. 附贈SSR交換券", 
                sub: "1次限定", 
                gems: 1500, 
                price: 830, 
                points: 790,
                limit: 1, 
                badge: "", 
                category: "limited", 
                desc: "附贈SSR交換券" 
            },
            { 
                id: "sp_6", 
                name: "3.5th Anniv. 附贈★3交換券", 
                sub: "1次限定", 
                gems: 1500, 
                price: 830, 
                points: 790,
                limit: 1, 
                badge: "", 
                category: "limited", 
                desc: "附贈★3交換券" 
            },
            { 
                id: "sp_7", 
                name: "賽馬娘訂閱KFC合作禮包", 
                sub: "1次限定", 
                gems: 700, 
                price: 390, 
                points: 440, 
                limit: 1, 
                badge: "細水長流", 
                category: "limited", 
                desc: "" 
            },
            // 常駐區
            { id: "gem_1", name: "普通寶石 10000", sub: "10000顆", gems: 10000, price: 5490, points: 5180, limit: 99, badge: null, category: "normal", desc: "" },
            { id: "gem_2", name: "普通寶石 5580", sub: "5580顆", gems: 5580, price: 2990, points: 2990, limit: 99, badge: null, category: "normal", desc: "" },
            { id: "gem_3", name: "普通寶石 4430", sub: "4430顆", gems: 4430, price: 2390, points: 2240, limit: 99, badge: null, category: "normal", desc: "" },
            { id: "gem_4", name: "普通寶石 2750", sub: "2750顆", gems: 2750, price: 1490, points: 1490, limit: 99, badge: null, category: "normal", desc: "" },
            { id: "gem_5", name: "普通寶石 2170", sub: "2170顆", gems: 2170, price: 1190, points: 1190, limit: 99, badge: null, category: "normal", desc: "" },
            { id: "gem_6", name: "普通寶石 1300", sub: "1300顆", gems: 1300, price: 720, points: 740, limit: 99, badge: null, category: "normal", desc: "" },
            { id: "gem_7", name: "普通寶石 810", sub: "810顆", gems: 810, price: 450, points: 465, limit: 99, badge: null, category: "normal", desc: "" },
            { id: "gem_8", name: "普通寶石 700", sub: "700顆", gems: 700, price: 390, points: 440, limit: 99, badge: null, category: "normal", desc: "" },
            { id: "gem_9", name: "普通寶石 650", sub: "650顆", gems: 650, price: 360, points: 365, limit: 99, badge: null, category: "normal", desc: "" },
            { id: "gem_10", name: "普通寶石 200", sub: "200顆", gems: 200, price: 120, points: 125, limit: 99, badge: null, category: "normal", desc: "" },
            { id: "gem_11", name: "普通寶石 160", sub: "160顆", gems: 160, price: 100, points: 90, limit: 99, badge: null, category: "normal", desc: "" },
            { id: "gem_12", name: "普通寶石 45", sub: "45顆", gems: 45, price: 30, points: 30, limit: 99, badge: null, category: "normal", desc: "" }
        ];

        const BONUS_TIERS = [
            { points: 60, reward: 100 },
            { points: 1250, reward: 250 },
            { points: 3600, reward: 500 },
            { points: 6600, reward: 750 },
            { points: 10800, reward: 1000 },
            { points: 16800, reward: 1250 },
            { points: 24300, reward: 1750 },
            { points: 34800, reward: 2500 },
            { points: 48300, reward: 3500 },
            { points: 63000, reward: 4000 },
        ];

        // --- Main Component ---
        const UmaCalculator = () => {
            const [quantities, setQuantities] = useState({});
            const [useDiscount, setUseDiscount] = useState(true);
            const [showDetails, setShowDetails] = useState(false);
            const [activeTab, setActiveTab] = useState('limited');

            const updateQuantity = (id, delta, limit) => {
                setQuantities(prev => {
                    const current = prev[id] || 0;
                    const next = Math.max(0, Math.min(limit, current + delta));
                    return { ...prev, [id]: next };
                });
            };

            const resetCart = () => setQuantities({});

            const stats = useMemo(() => {
                let totalBaseGems = 0;
                let totalPriceRaw = 0;
                let totalPoints = 0;
                let cartItems = [];

                PRODUCTS.forEach(p => {
                    const qty = quantities[p.id] || 0;
                    if (qty > 0) {
                        totalBaseGems += p.gems * qty;
                        totalPriceRaw += p.price * qty;
                        totalPoints += p.points * qty;
                        cartItems.push({ ...p, qty });
                    }
                });

                let totalBonusGems = 0;
                let nextTier = null;
                let achievedTiers = [];

                for (const tier of BONUS_TIERS) {
                    if (totalPoints >= tier.points) {
                        totalBonusGems += tier.reward;
                        achievedTiers.push(tier);
                    } else {
                        if (!nextTier) nextTier = tier;
                    }
                }

                const totalGems = totalBaseGems + totalBonusGems;
                const finalPrice = useDiscount ? Math.round(totalPriceRaw * 0.94) : totalPriceRaw;
                const cpValue = finalPrice > 0 ? (totalGems / finalPrice).toFixed(3) : 0;
                
                return {
                    totalBaseGems,
                    totalPriceRaw,
                    totalPoints,
                    totalBonusGems,
                    totalGems,
                    finalPrice,
                    cpValue,
                    nextTier,
                    achievedTiers,
                    cartItems
                };
            }, [quantities, useDiscount]);

            const fmt = (num) => new Intl.NumberFormat('en-US').format(num);

            const ProductCard = ({ product }) => {
                const qty = quantities[product.id] || 0;
                const unitPrice = useDiscount ? product.price * 0.94 : product.price;
                const itemCP = unitPrice > 0 ? (product.gems / unitPrice).toFixed(2) : 0;
                
                // 特殊標記：如果積分 > 價格 20% 以上，顯示積分UP
                const isPointsUp = product.points > product.price * 1.2;

                return (
                    <div className={`bg-white rounded-xl shadow-sm border transition-all duration-200 overflow-hidden relative ${qty > 0 ? 'border-emerald-400 ring-1 ring-emerald-100' : 'border-slate-200'}`}>
                        {parseFloat(itemCP) > 2.5 && (
                            <div className="">
                            </div>
                        )}
                        
                        <div className="p-3 flex flex-col h-full">
                            <div className="flex justify-between items-start mb-2">
                                <div>
                                    <h3 className="font-bold text-slate-800 text-sm md:text-base leading-tight flex items-center gap-2">
                                        {product.name}
                                    </h3>
                                    <p className="text-xs text-slate-400 mt-0.5">{product.sub} {product.desc && `· ${product.desc}`}</p>
                                </div>
                                <div className="flex flex-col items-end gap-1">
                                    {product.badge && (
                                        <span className="bg-emerald-100 text-emerald-700 text-[10px] px-1.5 py-0.5 rounded font-bold whitespace-nowrap">{product.badge}</span>
                                    )}
                                    {isPointsUp && (
                                        <span className="bg-indigo-100 text-indigo-700 text-[10px] px-1.5 py-0.5 rounded font-bold whitespace-nowrap">積分UP</span>
                                    )}
                                </div>
                            </div>

                            <div className="flex items-end justify-between mt-auto">
                                <div className="space-y-1">
                                    <div className="text-emerald-600 font-bold text-sm">${fmt(product.price)}</div>
                                    <div className="text-[10px] text-slate-400 flex flex-col sm:flex-row gap-1">
                                        <span>{fmt(product.gems)}石</span>
                                        <span className="hidden sm:inline">|</span>
                                        <span className={`${isPointsUp ? 'text-indigo-600 font-bold' : ''}`}>{fmt(product.points)}分</span>
                                    </div>
                                </div>

                                <div className="flex items-center gap-2">
                                    <button 
                                        onClick={() => updateQuantity(product.id, -1, product.limit)}
                                        disabled={qty === 0}
                                        className="w-8 h-8 rounded-full bg-slate-100 text-slate-600 flex items-center justify-center hover:bg-slate-200 disabled:opacity-30 transition font-bold"
                                    >-</button>
                                    <div className="w-6 text-center font-bold text-lg">{qty}</div>
                                    <button 
                                        onClick={() => updateQuantity(product.id, 1, product.limit)}
                                        disabled={qty >= product.limit}
                                        className="w-8 h-8 rounded-full bg-emerald-100 text-emerald-700 flex items-center justify-center hover:bg-emerald-200 disabled:opacity-30 transition font-bold"
                                    >+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-slate-50 text-slate-800 pb-40 md:pb-10 font-sans">
                    {/* Header */}
                    <header className="bg-white border-b border-slate-200 sticky top-0 z-30 shadow-sm">
                        <div className="max-w-4xl mx-auto px-4 py-3 flex justify-between items-center">
                            <div className="flex items-center gap-2">
                                <div className="bg-emerald-600 text-white p-1.5 rounded-lg">
                                    <CalculatorIcon className="w-5 h-5" />
                                </div>
                                <div>
                                    <h1 className="font-bold text-base md:text-lg leading-none">賽馬娘3.5th優惠計算</h1>
                                </div>
                            </div>
                            
                            <div className="flex items-center gap-2">
                                <label className={`flex items-center gap-2 cursor-pointer px-3 py-1.5 rounded-full text-xs font-bold transition select-none ${useDiscount ? 'bg-emerald-100 text-emerald-700' : 'bg-slate-100 text-slate-500'}`}>
                                    <input type="checkbox" checked={useDiscount} onChange={(e) => setUseDiscount(e.target.checked)} className="hidden" />
                                    <Zap className={`w-3 h-3 ${useDiscount ? 'fill-current' : ''}`} />
                                    <span>MyCard 94折</span>
                                </label>
                                {stats.totalPriceRaw > 0 && (
                                    <button onClick={resetCart} className="flex items-center gap-1 bg-rose-50 hover:bg-rose-100 text-rose-600 px-3 py-1.5 rounded-full transition text-xs font-bold" title="清空購物車">
                                        <Trash className="w-3.5 h-3.5" />
                                        <span className="hidden sm:inline">清空</span>
                                    </button>
                                )}
                            </div>
                        </div>
                    </header>

                    <main className="max-w-4xl mx-auto p-4 grid md:grid-cols-12 gap-6">
                        {/* Left: Product List */}
                        <div className="md:col-span-7">
                            <div className="flex gap-2 mb-4 bg-slate-100 p-1 rounded-lg">
                                <button onClick={() => setActiveTab('limited')} className={`flex-1 py-1.5 text-sm font-bold rounded-md transition ${activeTab === 'limited' ? 'bg-white text-slate-800 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}>限定 / 高CP區</button>
                                <button onClick={() => setActiveTab('normal')} className={`flex-1 py-1.5 text-sm font-bold rounded-md transition ${activeTab === 'normal' ? 'bg-white text-slate-800 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}>普通寶石區</button>
                            </div>

                            <div className="grid gap-3 animate-fade-in">
                                {PRODUCTS.filter(p => p.category === activeTab).map(product => (
                                    <ProductCard key={product.id} product={product} />
                                ))}
                            </div>
                        </div>

                        {/* Right: Stats */}
                        <div className="md:col-span-5">
                            <div className="sticky top-20 space-y-4">
                                <div className="bg-white rounded-2xl shadow border border-slate-100 overflow-hidden">
                                    <div className="p-4 border-b border-slate-50">
                                        <div className="flex justify-between items-center mb-4">
                                            <h2 className="font-bold text-slate-700 flex items-center gap-2">
                                                <TrendingUp className="w-5 h-5 text-emerald-500" />
                                                結算明細
                                            </h2>
                                            <div className="text-right">
                                                <div className="text-2xl font-black text-slate-800 leading-none">
                                                    {stats.cpValue} <span className="text-sm font-normal text-slate-400">CP</span>
                                                </div>
                                                <div className="text-[10px] text-slate-400">每一塊錢買到的寶石</div>
                                            </div>
                                        </div>

                                        <div className="bg-slate-50 rounded-lg p-3 border border-slate-100 mb-4">
                                            <div className="flex justify-between text-xs mb-1.5">
                                                <span className="font-bold text-slate-600">目前積分: {fmt(stats.totalPoints)}</span>
                                                <span className="text-slate-500">
                                                    {stats.nextTier ? `下一階: ${fmt(stats.nextTier.points)}` : '已達成所有目標'}
                                                </span>
                                            </div>
                                            <div className="h-2.5 w-full bg-slate-200 rounded-full overflow-hidden">
                                                <div className="h-full bg-emerald-500 transition-all duration-500" style={{ width: `${Math.min(100, stats.nextTier ? (stats.totalPoints / stats.nextTier.points) * 100 : 100)}%` }}></div>
                                            </div>
                                            {stats.nextTier && (
                                                <div className="text-xs text-center mt-1.5 text-emerald-600 font-medium bg-emerald-50 py-1 rounded">
                                                    差 {fmt(stats.nextTier.points - stats.totalPoints)} 分獲得 +{stats.nextTier.reward} 石
                                                </div>
                                            )}
                                        </div>

                                        <div className="grid grid-cols-2 gap-2 text-center">
                                            <div className="bg-slate-50 p-2 rounded border border-slate-100">
                                                <div className="text-[10px] text-slate-500">總花費</div>
                                                <div className="font-bold text-lg text-slate-800">${fmt(stats.finalPrice)}</div>
                                                {useDiscount && <div className="text-[10px] text-emerald-600">已省 ${fmt(stats.totalPriceRaw - stats.finalPrice)}</div>}
                                            </div>
                                            <div className="bg-amber-50 p-2 rounded border border-amber-100">
                                                <div className="text-[10px] text-amber-600">總寶石</div>
                                                <div className="font-bold text-lg text-amber-600">{fmt(stats.totalGems)}</div>
                                                <div className="text-[10px] text-amber-600/70">含贈 {fmt(stats.totalBonusGems)}</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-slate-50 p-3 max-h-[300px] overflow-y-auto custom-scrollbar">
                                        <div className="text-xs font-bold text-slate-500 mb-2 uppercase">購物車內容</div>
                                        {stats.cartItems.length === 0 ? (
                                            <div className="text-center text-slate-400 py-4 text-xs">購物車是空的</div>
                                        ) : (
                                            <div className="space-y-2">
                                                {stats.cartItems.map(item => (
                                                    <div key={item.id} className="flex justify-between text-xs border-b border-slate-200 pb-1 last:border-0">
                                                        <div className="flex-1">
                                                            <span className="text-slate-700 font-medium">{item.name}</span>
                                                            <span className="text-slate-400 ml-1">x{item.qty}</span>
                                                        </div>
                                                        <div className="text-right">
                                                            <div className="text-slate-600">${fmt(item.price * item.qty)}</div>
                                                            <div className="text-slate-400">{fmt(item.points * item.qty)}分</div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                        
                                        <div className="mt-4 pt-2 border-t border-slate-200">
                                            <div className="text-xs font-bold text-slate-500 mb-2 uppercase">達標獎勵 (已自動累計)</div>
                                            {stats.achievedTiers.length > 0 ? (
                                                stats.achievedTiers.map(tier => (
                                                    <div key={tier.points} className="flex items-center gap-2 text-xs text-emerald-600 mb-1">
                                                        <Check className="w-3 h-3" />
                                                        <span>滿 {tier.points} 分：贈 {tier.reward} 石</span>
                                                    </div>
                                                ))
                                            ) : (
                                                <div className="text-xs text-slate-400">尚未達成任何獎勵</div>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </main>

                    {/* Mobile Bottom Bar */}
                    <div className="md:hidden fixed bottom-0 left-0 right-0 bg-white shadow-[0_-2px_10px_rgba(0,0,0,0.1)] z-40 border-t border-slate-100 pb-safe">
                        <div className="flex items-center justify-between p-3 cursor-pointer bg-white" onClick={() => setShowDetails(!showDetails)}>
                            <div className="flex flex-col">
                                <span className="text-xs text-slate-500">總計 {useDiscount ? '(94折)' : ''}</span>
                                <span className="font-black text-xl text-slate-800">${fmt(stats.finalPrice)}</span>
                            </div>
                            <div className="flex items-center gap-3">
                                <div className="text-right">
                                    <div className="text-xs text-amber-600 font-bold flex items-center justify-end gap-1">
                                        {fmt(stats.totalGems)} <Crown className="w-3 h-3 fill-current" />
                                    </div>
                                    <div className="text-[10px] text-slate-400">{stats.cpValue} CP</div>
                                </div>
                                <div className={`transition-transform duration-300 ${showDetails ? 'rotate-180' : ''}`}>
                                    <ChevronUp className="w-5 h-5 text-slate-400" />
                                </div>
                            </div>
                        </div>

                        {showDetails && (
                            <div className="bg-slate-50 p-4 border-t border-slate-200 max-h-[60vh] overflow-y-auto flex flex-col">
                                <div className="space-y-4 flex-1">
                                    <div className="grid grid-cols-2 gap-3">
                                        <div className="bg-white p-3 rounded-lg border border-slate-200 text-center">
                                            <div className="text-xs text-slate-500">累積積分</div>
                                            <div className="text-lg font-bold text-indigo-600">{fmt(stats.totalPoints)}</div>
                                        </div>
                                        <div className="bg-white p-3 rounded-lg border border-slate-200 text-center">
                                            <div className="text-xs text-slate-500">贈送寶石</div>
                                            <div className="text-lg font-bold text-amber-500">+{fmt(stats.totalBonusGems)}</div>
                                        </div>
                                    </div>
                                    {stats.nextTier && (
                                        <div className="bg-indigo-50 p-3 rounded text-center text-xs text-indigo-700">
                                            再累積 <b>{stats.nextTier.points - stats.totalPoints}</b> 分<br/>即可獲得 <b>{stats.nextTier.reward}</b> 顆寶石
                                        </div>
                                    )}
                                    <div className="text-xs space-y-2">
                                        <div className="font-bold text-slate-500">已選商品：</div>
                                        {stats.cartItems.map(item => (
                                            <div key={item.id} className="flex justify-between border-b border-slate-200 pb-1">
                                                <span>{item.name} x{item.qty}</span>
                                                <span>${fmt(item.price * item.qty)}</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                
                                <button onClick={() => { resetCart(); setShowDetails(false); }} className="w-full mt-6 py-3 bg-rose-50 hover:bg-rose-100 text-rose-600 rounded-xl text-sm font-bold flex items-center justify-center gap-2 transition active:scale-95">
                                    <Trash className="w-4 h-4" />
                                    清空所有商品
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<UmaCalculator />);
    </script>
</body>
</html>